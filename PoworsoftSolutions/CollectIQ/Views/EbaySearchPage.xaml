<?xml version="1.0" encoding="utf-8" ?>
<ContentPage 
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="CollectIQ.Views.EbaySearchPage"
    Title="eBay Matches"
    BackgroundColor="#0B0E11">

    <Grid RowDefinitions="Auto,*,Auto" Padding="20" RowSpacing="15">

        <!-- HEADER -->
        <Label Text="eBay Card Recognition"
               FontSize="28"
               FontAttributes="Bold"
               HorizontalOptions="Center"
               TextColor="#6CD4FF"
               Margin="0,10,0,5" />

        <!-- RESULTS LIST -->
        <CollectionView x:Name="EbayResultsView"
                        Grid.Row="1"
                        SelectionMode="None"
                        VerticalOptions="FillAndExpand"
                        BackgroundColor="Transparent">

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <SwipeView>
                        <SwipeView.RightItems>
                            <SwipeItems Mode="Reveal">

                                <!-- ADD TO COLLECTION -->
                                <SwipeItem
                                    Text="Add to Collection"
                                    Style="{StaticResource AccentButton}"
                                    IconImageSource="add_icon.png"
                                    Invoked="OnAddToCollectionSwipe" />

                                <!-- VIEW ON EBAY -->
                                <SwipeItem
                                    Text="View on eBay"
                                    Style="{StaticResource AccentButton}"
                                    IconImageSource="open_link_icon.png"
                                    Invoked="OnViewOnEbaySwipe" />

                            </SwipeItems>
                        </SwipeView.RightItems>

                        <Frame CornerRadius="12"
                               Padding="10"
                               Margin="0,8,0,0"
                               BackgroundColor="#14181C"
                               BorderColor="#00B4D8"
                               HasShadow="True">

                            <Grid ColumnDefinitions="100, *"
                                  ColumnSpacing="12"
                                  VerticalOptions="Center"
                                  RowDefinitions="Auto,Auto">

                                <!-- Card Image (Left) -->
                                <Image Grid.RowSpan="3"
                                       Source="{Binding ImageUrl}"
                                       WidthRequest="100"
                                       HeightRequest="100"
                                       Aspect="AspectFit"
                                       VerticalOptions="Center"
                                       HorizontalOptions="Start" />

                                <!-- Card Title -->
                                <Label Grid.Column="1"
                                       Grid.Row="0"
                                       Text="{Binding Title}"
                                       FontSize="16"
                                       FontAttributes="Bold"
                                       TextColor="White"
                                       LineBreakMode="WordWrap"
                                       MaxLines="2"
                                       VerticalOptions="Start" />

                                <!-- Card Price -->
                                <Label Grid.Column="1"
                                       Grid.Row="1"
                                       Text="{Binding Price, StringFormat='${0:F2}'}"
                                       FontSize="14"
                                       TextColor="#6CD4FF"
                                       VerticalOptions="End"
                                       Margin="0,4,0,0" />

                            </Grid>
                        </Frame>
                    </SwipeView>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- MANUAL SEARCH SECTION -->
        <StackLayout Grid.Row="2" Spacing="10" Padding="0,10,0,0">

            <Label Text="Didnâ€™t find your card? Search manually:"
                   FontSize="16"
                   TextColor="#A8EFFF"
                   HorizontalOptions="Center" />

            <Entry x:Name="ManualSearchBox"
                   Placeholder="Enter card details or keywords..."
                   FontSize="14"
                   BackgroundColor="#111418"
                   TextColor="White"
                   PlaceholderColor="#6CD4FF"
                   HeightRequest="45"
                   Margin="0,0,0,5"
                   Keyboard="Text" />

            <Button Text="Search eBay Again"
                    Clicked="OnManualSearchClicked"
                    BackgroundColor="#00B4FF"
                    TextColor="White"
                    FontAttributes="Bold"
                    CornerRadius="10"
                    HeightRequest="48" />

            <Button Text="Add Manually to Collection"
                    BackgroundColor="#001020"
                    TextColor="#6CD4FF"
                    BorderColor="#00B4FF"
                    BorderWidth="2"
                    CornerRadius="10"
                    HeightRequest="48"
                    Clicked="Add_Manual_Button_Clicked" />
        </StackLayout>
    </Grid>
</ContentPage>
